!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self)["@wonderlandlabs/mirror"]=e()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}function r(t){return"function"==typeof t}var n=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;n=t},get useDeprecatedSynchronousErrorHandling(){return n}};function i(t){setTimeout((function(){throw t}),0)}var s={closed:!0,next:function(t){},error:function(t){if(o.useDeprecatedSynchronousErrorHandling)throw t;i(t)},complete:function(){}},u=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function c(t){return null!==t&&"object"==typeof t}var a=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),f=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this._parentOrParents,o=this._ctorUnsubscribe,i=this._unsubscribe,s=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var f=0;f<n.length;++f){n[f].remove(this)}if(r(i)){o&&(this._unsubscribe=void 0);try{i.call(this)}catch(t){e=t instanceof a?h(t.errors):[t]}}if(u(s)){f=-1;for(var p=s.length;++f<p;){var l=s[f];if(c(l))try{l.unsubscribe()}catch(t){e=e||[],t instanceof a?e=e.concat(h(t.errors)):e.push(t)}}}if(e)throw new a(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof t){if(o===this)return r;r._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function h(t){return t.reduce((function(t,e){return t.concat(e instanceof a?e.errors:e)}),[])}var p=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),l=function(t){function r(e,n,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=s;break;case 1:if(!e){i.destination=s;break}if("object"==typeof e){e instanceof r?(i.syncErrorThrowable=e.syncErrorThrowable,i.destination=e,e.add(i)):(i.syncErrorThrowable=!0,i.destination=new d(i,e));break}default:i.syncErrorThrowable=!0,i.destination=new d(i,e,n,o)}return i}return e(r,t),r.prototype[p]=function(){return this},r.create=function(t,e,n){var o=new r(t,e,n);return o.syncErrorThrowable=!1,o},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},r}(f),d=function(t){function n(e,n,o,i){var u,c=t.call(this)||this;c._parentSubscriber=e;var a=c;return r(n)?u=n:n&&(u=n.next,o=n.error,i=n.complete,n!==s&&(r((a=Object.create(n)).unsubscribe)&&c.add(a.unsubscribe.bind(a)),a.unsubscribe=c.unsubscribe.bind(c))),c._context=a,c._next=u,c._error=o,c._complete=i,c}return e(n,t),n.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},n.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=o.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):i(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;i(t)}}},n.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},n.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw t;i(t)}},n.prototype.__tryOrSetError=function(t,e,r){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return o.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(i(e),!0)}return!1},n.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},n}(l);var y=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function b(t){return t}function v(t){return 0===t.length?b:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var _=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=function(t,e,r){if(t){if(t instanceof l)return t;if(t[p])return t[p]()}return t||e||r?new l(t,e,r):new l(s)}(t,e,r);if(n?i.add(n.call(i,this.source)):i.add(this.source||o.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),o.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){o.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,o=e.isStopped;if(r||o)return!1;t=n&&n instanceof l?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=m(e))((function(e,n){var o;o=r.subscribe((function(e){try{t(e)}catch(t){n(t),o&&o.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[y]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:v(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=m(t))((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function m(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}var g=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),w=function(t){function r(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return e(r,t),r.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},r}(f),S=function(t){function r(e){var r=t.call(this,e)||this;return r.destination=e,r}return e(r,t),r}(l),E=function(t){function r(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return e(r,t),r.prototype[p]=function(){return new S(this)},r.prototype.lift=function(t){var e=new $(this,this);return e.operator=t,e},r.prototype.next=function(t){if(this.closed)throw new g;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),o=0;o<r;o++)n[o].next(t)},r.prototype.error=function(t){if(this.closed)throw new g;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),o=0;o<r;o++)n[o].error(t);this.observers.length=0},r.prototype.complete=function(){if(this.closed)throw new g;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},r.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},r.prototype._trySubscribe=function(e){if(this.closed)throw new g;return t.prototype._trySubscribe.call(this,e)},r.prototype._subscribe=function(t){if(this.closed)throw new g;return this.hasError?(t.error(this.thrownError),f.EMPTY):this.isStopped?(t.complete(),f.EMPTY):(this.observers.push(t),new w(this,t))},r.prototype.asObservable=function(){var t=new _;return t.source=this,t},r.create=function(t,e){return new $(t,e)},r}(_),$=function(t){function r(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return e(r,t),r.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},r.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},r.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},r.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):f.EMPTY},r}(E),x=function(t){function r(e){var r=t.call(this)||this;return r._value=e,r}return e(r,t),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new g;return this._value},r.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},r}(E);function O(t){return t&&"function"==typeof t.schedule}var P=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.complete()}};function j(t,e){return new _((function(r){var n=new f,o=0;return n.add(e.schedule((function(){o!==t.length?(r.next(t[o++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}function A(t,e){return e?j(t,e):new _(P(t))}function T(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return O(r)?(t.pop(),j(t,r)):A(t)}function D(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new N(t,e))}}var N=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new k(t,this.project,this.thisArg))},t}(),k=function(t){function r(e,r,n){var o=t.call(this,e)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return e(r,t),r.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(l),I=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.notifyNext=function(t,e,r,n,o){this.destination.next(e)},r.prototype.notifyError=function(t,e){this.destination.error(t)},r.prototype.notifyComplete=function(t){this.destination.complete()},r}(l),M=function(t){function r(e,r,n){var o=t.call(this)||this;return o.parent=e,o.outerValue=r,o.outerIndex=n,o.index=0,o}return e(r,t),r.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},r.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},r}(l);function V(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var R=V(),z=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function C(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var F=function(t){if(t&&"function"==typeof t[y])return n=t,function(t){var e=n[y]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(z(t))return P(t);if(C(t))return r=t,function(t){return r.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,i),t};if(t&&"function"==typeof t[R])return e=t,function(t){for(var r=e[R]();;){var n=void 0;try{n=r.next()}catch(e){return t.error(e),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof r.return&&t.add((function(){r.return&&r.return()})),t};var e,r,n,o=c(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function U(t,e,r,n,o){if(void 0===o&&(o=new M(t,r,n)),!o.closed)return e instanceof _?e.subscribe(o):F(e)(o)}var H={};var Q=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new Y(t,this.resultSelector))},t}(),Y=function(t){function r(e,r){var n=t.call(this,e)||this;return n.resultSelector=r,n.active=0,n.values=[],n.observables=[],n}return e(r,t),r.prototype._next=function(t){this.values.push(H),this.observables.push(t)},r.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var r=0;r<e;r++){var n=t[r];this.add(U(this,n,void 0,r))}}},r.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},r.prototype.notifyNext=function(t,e,r){var n=this.values,o=n[r],i=this.toRespond?o===H?--this.toRespond:this.toRespond:0;n[r]=e,0===i&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))},r.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(I);function K(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[y]}(t))return function(t,e){return new _((function(r){var n=new f;return n.add(e.schedule((function(){var o=t[y]();n.add(o.subscribe({next:function(t){n.add(e.schedule((function(){return r.next(t)})))},error:function(t){n.add(e.schedule((function(){return r.error(t)})))},complete:function(){n.add(e.schedule((function(){return r.complete()})))}}))}))),n}))}(t,e);if(C(t))return function(t,e){return new _((function(r){var n=new f;return n.add(e.schedule((function(){return t.then((function(t){n.add(e.schedule((function(){r.next(t),n.add(e.schedule((function(){return r.complete()})))})))}),(function(t){n.add(e.schedule((function(){return r.error(t)})))}))}))),n}))}(t,e);if(z(t))return j(t,e);if(function(t){return t&&"function"==typeof t[R]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new _((function(r){var n,o=new f;return o.add((function(){n&&"function"==typeof n.return&&n.return()})),o.add(e.schedule((function(){n=t[R](),o.add(e.schedule((function(){if(!r.closed){var t,e;try{var o=n.next();t=o.value,e=o.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}})))}))),o}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}var q=function(t){function r(e){var r=t.call(this)||this;return r.parent=e,r}return e(r,t),r.prototype._next=function(t){this.parent.notifyNext(t)},r.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},r}(l),G=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.notifyNext=function(t){this.destination.next(t)},r.prototype.notifyError=function(t){this.destination.error(t)},r.prototype.notifyComplete=function(){this.destination.complete()},r}(l);function L(t,e){if(!e.closed)return t instanceof _?t.subscribe(e):F(t)(e)}function W(t,e){return function(r){return r.lift(new B(t,e))}}var B=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new J(t,this.predicate,this.thisArg))},t}(),J=function(t){function r(e,r,n){var o=t.call(this,e)||this;return o.predicate=r,o.thisArg=n,o.count=0,o}return e(r,t),r.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},r}(l);function X(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if("production"!==process.env.NODE_ENV){var o=Ft[t],i=o?"function"==typeof o?o.apply(null,r):o:"unknown error nr: "+t;throw Error("[Immer] "+i)}throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map((function(t){return"'"+t+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Z(t){return!!t&&!!t[zt]}function tt(t){return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===Ut}(t)||Array.isArray(t)||!!t[Rt]||!!t.constructor[Rt]||it(t)||st(t))}function et(t,e,r){void 0===r&&(r=!1),0===rt(t)?(r?Object.keys:Ht)(t).forEach((function(n){r&&"symbol"==typeof n||e(n,t[n],t)})):t.forEach((function(r,n){return e(n,r,t)}))}function rt(t){var e=t[zt];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:it(t)?2:st(t)?3:0}function nt(t,e){return 2===rt(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function ot(t,e,r){var n=rt(t);2===n?t.set(e,r):3===n?(t.delete(e),t.add(r)):t[e]=r}function it(t){return kt&&t instanceof Map}function st(t){return It&&t instanceof Set}function ut(t){return t.o||t.t}function ct(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=Qt(t);delete e[zt];for(var r=Ht(e),n=0;n<r.length;n++){var o=r[n],i=e[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(e[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:t[o]})}return Object.create(Object.getPrototypeOf(t),e)}function at(t,e){return void 0===e&&(e=!1),ht(t)||Z(t)||!tt(t)?t:(rt(t)>1&&(t.set=t.add=t.clear=t.delete=ft),Object.freeze(t),e&&et(t,(function(t,e){return at(e,!0)}),!0),t)}function ft(){X(2)}function ht(t){return null==t||"object"!=typeof t||Object.isFrozen(t)}function pt(t){var e=Yt[t];return e||X(18,t),e}function lt(){return"production"===process.env.NODE_ENV||Dt||X(0),Dt}function dt(t,e){e&&(pt("Patches"),t.u=[],t.s=[],t.v=e)}function yt(t){bt(t),t.p.forEach(_t),t.p=null}function bt(t){t===Dt&&(Dt=t.l)}function vt(t){return Dt={p:[],l:Dt,h:t,m:!0,_:0}}function _t(t){var e=t[zt];0===e.i||1===e.i?e.j():e.O=!0}function mt(t,e){e._=e.p.length;var r=e.p[0],n=void 0!==t&&t!==r;return e.h.g||pt("ES5").S(e,t,n),n?(r[zt].P&&(yt(e),X(4)),tt(t)&&(t=gt(e,t),e.l||St(e,t)),e.u&&pt("Patches").M(r[zt],t,e.u,e.s)):t=gt(e,r,[]),yt(e),e.u&&e.v(e.u,e.s),t!==Vt?t:void 0}function gt(t,e,r){if(ht(e))return e;var n=e[zt];if(!n)return et(e,(function(o,i){return wt(t,n,e,o,i,r)}),!0),e;if(n.A!==t)return e;if(!n.P)return St(t,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=4===n.i||5===n.i?n.o=ct(n.k):n.o;et(3===n.i?new Set(o):o,(function(e,i){return wt(t,n,o,e,i,r)})),St(t,o,!1),r&&t.u&&pt("Patches").R(n,r,t.u,t.s)}return n.o}function wt(t,e,r,n,o,i){if("production"!==process.env.NODE_ENV&&o===r&&X(5),Z(o)){var s=gt(t,o,i&&e&&3!==e.i&&!nt(e.D,n)?i.concat(n):void 0);if(ot(r,n,s),!Z(s))return;t.m=!1}if(tt(o)&&!ht(o)){if(!t.h.F&&t._<1)return;gt(t,o),e&&e.A.l||St(t,o)}}function St(t,e,r){void 0===r&&(r=!1),t.h.F&&t.m&&at(e,r)}function Et(t,e){var r=t[zt];return(r?ut(r):t)[e]}function $t(t,e){if(e in t)for(var r=Object.getPrototypeOf(t);r;){var n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Object.getPrototypeOf(r)}}function xt(t){t.P||(t.P=!0,t.l&&xt(t.l))}function Ot(t){t.o||(t.o=ct(t.t))}function Pt(t,e,r){var n=it(e)?pt("MapSet").N(e,r):st(e)?pt("MapSet").T(e,r):t.g?function(t,e){var r=Array.isArray(t),n={i:r?1:0,A:e?e.A:lt(),P:!1,I:!1,D:{},l:e,t:t,k:null,o:null,j:null,C:!1},o=n,i=Kt;r&&(o=[n],i=qt);var s=Proxy.revocable(o,i),u=s.revoke,c=s.proxy;return n.k=c,n.j=u,c}(e,r):pt("ES5").J(e,r);return(r?r.A:lt()).p.push(n),n}function jt(t){return Z(t)||X(22,t),function t(e){if(!tt(e))return e;var r,n=e[zt],o=rt(e);if(n){if(!n.P&&(n.i<4||!pt("ES5").K(n)))return n.t;n.I=!0,r=At(e,o),n.I=!1}else r=At(e,o);return et(r,(function(e,o){n&&function(t,e){return 2===rt(t)?t.get(e):t[e]}(n.t,e)===o||ot(r,e,t(o))})),3===o?new Set(r):r}(t)}function At(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return ct(t)}var Tt,Dt,Nt="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),kt="undefined"!=typeof Map,It="undefined"!=typeof Set,Mt="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Vt=Nt?Symbol.for("immer-nothing"):((Tt={})["immer-nothing"]=!0,Tt),Rt=Nt?Symbol.for("immer-draftable"):"__$immer_draftable",zt=Nt?Symbol.for("immer-state"):"__$immer_state",Ct="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",Ft={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(t){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+t},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(t){return"Cannot apply patch, path doesn't resolve: "+t},16:'Sets cannot have "replace" patches.',17:function(t){return"Unsupported patch operation: "+t},18:function(t){return"The plugin for '"+t+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+t+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(t){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+t+"'"},22:function(t){return"'current' expects a draft, got: "+t},23:function(t){return"'original' expects a draft, got: "+t},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},Ut=""+Object.prototype.constructor,Ht="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,Qt=Object.getOwnPropertyDescriptors||function(t){var e={};return Ht(t).forEach((function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)})),e},Yt={},Kt={get:function(t,e){if(e===zt)return t;var r=ut(t);if(!nt(r,e))return function(t,e,r){var n,o=$t(e,r);return o?"value"in o?o.value:null===(n=o.get)||void 0===n?void 0:n.call(t.k):void 0}(t,r,e);var n=r[e];return t.I||!tt(n)?n:n===Et(t.t,e)?(Ot(t),t.o[e]=Pt(t.A.h,n,t)):n},has:function(t,e){return e in ut(t)},ownKeys:function(t){return Reflect.ownKeys(ut(t))},set:function(t,e,r){var n=$t(ut(t),e);if(null==n?void 0:n.set)return n.set.call(t.k,r),!0;if(!t.P){var o=Et(ut(t),e),i=null==o?void 0:o[zt];if(i&&i.t===r)return t.o[e]=r,t.D[e]=!1,!0;if(function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}(r,o)&&(void 0!==r||nt(t.t,e)))return!0;Ot(t),xt(t)}return t.o[e]===r&&"number"!=typeof r&&(void 0!==r||e in t.o)||(t.o[e]=r,t.D[e]=!0,!0)},deleteProperty:function(t,e){return void 0!==Et(t.t,e)||e in t.t?(t.D[e]=!1,Ot(t),xt(t)):delete t.D[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var r=ut(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n?{writable:!0,configurable:1!==t.i||"length"!==e,enumerable:n.enumerable,value:r[e]}:n},defineProperty:function(){X(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){X(12)}},qt={};et(Kt,(function(t,e){qt[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),qt.deleteProperty=function(t,e){return"production"!==process.env.NODE_ENV&&isNaN(parseInt(e))&&X(13),Kt.deleteProperty.call(this,t[0],e)},qt.set=function(t,e,r){return"production"!==process.env.NODE_ENV&&"length"!==e&&isNaN(parseInt(e))&&X(14),Kt.set.call(this,t[0],e,r,t[0])};var Gt=new(function(){function t(t){var e=this;this.g=Mt,this.F=!0,this.produce=function(t,r,n){if("function"==typeof t&&"function"!=typeof r){var o=r;r=t;var i=e;return function(t){var e=this;void 0===t&&(t=o);for(var n=arguments.length,s=Array(n>1?n-1:0),u=1;u<n;u++)s[u-1]=arguments[u];return i.produce(t,(function(t){var n;return(n=r).call.apply(n,[e,t].concat(s))}))}}var s;if("function"!=typeof r&&X(6),void 0!==n&&"function"!=typeof n&&X(7),tt(t)){var u=vt(e),c=Pt(e,t,void 0),a=!0;try{s=r(c),a=!1}finally{a?yt(u):bt(u)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(t){return dt(u,n),mt(t,u)}),(function(t){throw yt(u),t})):(dt(u,n),mt(s,u))}if(!t||"object"!=typeof t){if((s=r(t))===Vt)return;return void 0===s&&(s=t),e.F&&at(s,!0),s}X(21,t)},this.produceWithPatches=function(t,r){return"function"==typeof t?function(r){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return e.produceWithPatches(r,(function(e){return t.apply(void 0,[e].concat(o))}))}:[e.produce(t,r,(function(t,e){n=t,o=e})),n,o];var n,o},"boolean"==typeof(null==t?void 0:t.useProxies)&&this.setUseProxies(t.useProxies),"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze)}var e=t.prototype;return e.createDraft=function(t){tt(t)||X(8),Z(t)&&(t=jt(t));var e=vt(this),r=Pt(this,t,void 0);return r[zt].C=!0,bt(e),r},e.finishDraft=function(t,e){var r=t&&t[zt];"production"!==process.env.NODE_ENV&&(r&&r.C||X(9),r.I&&X(10));var n=r.A;return dt(n,e),mt(void 0,n)},e.setAutoFreeze=function(t){this.F=t},e.setUseProxies=function(t){t&&!Mt&&X(20),this.g=t},e.applyPatches=function(t,e){var r;for(r=e.length-1;r>=0;r--){var n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}var o=pt("Patches").$;return Z(t)?o(t,e):this.produce(t,(function(t){return o(t,e.slice(r+1))}))},t}()),Lt=Gt.produce;Gt.produceWithPatches.bind(Gt),Gt.setAutoFreeze.bind(Gt),Gt.setUseProxies.bind(Gt),Gt.applyPatches.bind(Gt),Gt.createDraft.bind(Gt),Gt.finishDraft.bind(Gt);const Wt=Symbol("type:map"),Bt=Symbol("type:object"),Jt=Symbol("type:value"),Xt=Symbol("unnamed"),Zt=Symbol("ABSENT"),te=Symbol("CHILDREN"),ee="init",re="validate",ne="perform",oe="post",ie="final";var se=Object.freeze({__proto__:null,TYPE_MAP:Wt,TYPE_OBJECT:Bt,TYPE_VALUE:Jt,NAME_UNNAMED:Xt,ABSENT:Zt,CHILDREN:te,STAGE_INIT:ee,STAGE_VALIDATE:re,STAGE_PERFORM:ne,STAGE_POST:oe,STAGE_ERROR:"error",STAGE_FINAL:ie});const ue=require("lodash/isNumber");function ce(t){return t&&"object"==typeof t&&!Array.isArray(t)&&!(t instanceof Map)}function ae(t,e=!1){return Array.isArray(t)&&(!e||t.length)}const fe=t=>t&&t instanceof Map,he=t=>"function"==typeof t;function pe(t,e=!1){if(!ce(t)&&!fe(t))throw Object.assign(new Error("cannot convert target to object"),{target:t});let r=t;return ce(t)?e&&(r={...t}):fe(t)&&(r={},t.forEach((e,n)=>{if("number"==typeof n||"string"==typeof n)try{r[n]=e}catch(e){console.warn("toObj map/object conversion -- skipping exporting of child key",n,"of ",t)}})),r}const le=t=>t;const de=ue;function ye(t){return![Zt,Xt,void 0].includes(t)}var be=Object.freeze({__proto__:null,toMap:function(t,e){if(t instanceof Map)return e?new Map(t):t;const r=new Map;return Object.keys(t).forEach(e=>r.set(e,t[e])),r},isObj:ce,isArr:ae,isMap:fe,isFn:he,e:(t,e={})=>("string"==typeof t&&(t=new Error(t)),Object.assign(t,e)),isStr:function(t,e=!1){return"string"==typeof t&&(!e||!!t)},toObj:pe,asUserAction:function(t){if("string"!=typeof t)throw new Error("bad user action");for(;"$$"!==t.substr(0,2);)t=`$${t}`;return t},noop:le,maybeImmer:function(t){return tt(t)?Lt(t,le):t},isNumber:de,there:ye});var ve=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new _e(t,this.selector,this.caught))},t}(),_e=function(t){function r(e,r,n){var o=t.call(this,e)||this;return o.selector=r,o.caught=n,o}return e(r,t),r.prototype.error=function(e){if(!this.isStopped){var r=void 0;try{r=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var n=new q(this);this.add(n);var o=L(r,n);o!==n&&this.add(o)}},r}(G);var me=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new ge(t,this.compare,this.keySelector))},t}(),ge=function(t){function r(e,r,n){var o=t.call(this,e)||this;return o.keySelector=n,o.hasKey=!1,"function"==typeof r&&(o.compare=r),o}return e(r,t),r.prototype.compare=function(t,e){return t===e},r.prototype._next=function(t){var e;try{var r=this.keySelector;e=r?r(t):t}catch(t){return this.destination.error(t)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))},r}(l);function we(t,e){return function(t,e){return function(r){return r.lift(new me(t,e))}}((function(r,n){return e?e(r[t],n[t]):r[t]===n[t]}))}function Se(t,e){return"function"==typeof e?function(r){return r.pipe(Se((function(r,n){return(o=t(r,n),i?K(o,i):o instanceof _?o:new _(F(o))).pipe(D((function(t,o){return e(r,t,n,o)})));var o,i})))}:function(e){return e.lift(new Ee(t))}}var Ee=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new $e(t,this.project))},t}(),$e=function(t){function r(e,r){var n=t.call(this,e)||this;return n.project=r,n.index=0,n}return e(r,t),r.prototype._next=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this._innerSub(e)},r.prototype._innerSub=function(t){var e=this.innerSubscription;e&&e.unsubscribe();var r=new q(this),n=this.destination;n.add(r),this.innerSubscription=L(t,r),this.innerSubscription!==r&&n.add(this.innerSubscription)},r.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},r.prototype._unsubscribe=function(){this.innerSubscription=void 0},r.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&t.prototype._complete.call(this)},r.prototype.notifyNext=function(t){this.destination.next(t)},r}(G);function xe(t){return e=>T(e).pipe(W(e=>!he(t.$test)||!t.$test(e)),function(t){return function(e){var r=new ve(t),n=e.lift(r);return r.caught=n}}(()=>T()))}!function(){function t(t,e){function r(){this.constructor=t}o(t,e),t.prototype=(r.prototype=e.prototype,new r)}function e(t){t.o||(t.D=new Map,t.o=new Map(t.t))}function r(t){t.o||(t.o=new Set,t.t.forEach((function(e){if(tt(e)){var r=Pt(t.A.h,e,t);t.p.set(e,r),t.o.add(r)}else t.o.add(e)})))}function n(t){t.O&&X(3,JSON.stringify(ut(t)))}var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},i=function(){function r(t,e){return this[zt]={i:2,l:e,A:e?e.A:lt(),P:!1,I:!1,o:void 0,D:void 0,t:t,k:this,C:!1,O:!1},this}t(r,Map);var o=r.prototype;return Object.defineProperty(o,"size",{get:function(){return ut(this[zt]).size}}),o.has=function(t){return ut(this[zt]).has(t)},o.set=function(t,r){var o=this[zt];return n(o),ut(o).has(t)&&ut(o).get(t)===r||(e(o),xt(o),o.D.set(t,!0),o.o.set(t,r),o.D.set(t,!0)),this},o.delete=function(t){if(!this.has(t))return!1;var r=this[zt];return n(r),e(r),xt(r),r.D.set(t,!1),r.o.delete(t),!0},o.clear=function(){var t=this[zt];n(t),ut(t).size&&(e(t),xt(t),t.D=new Map,et(t.t,(function(e){t.D.set(e,!1)})),t.o.clear())},o.forEach=function(t,e){var r=this;ut(this[zt]).forEach((function(n,o){t.call(e,r.get(o),o,r)}))},o.get=function(t){var r=this[zt];n(r);var o=ut(r).get(t);if(r.I||!tt(o))return o;if(o!==r.t.get(t))return o;var i=Pt(r.A.h,o,r);return e(r),r.o.set(t,i),i},o.keys=function(){return ut(this[zt]).keys()},o.values=function(){var t,e=this,r=this.keys();return(t={})[Ct]=function(){return e.values()},t.next=function(){var t=r.next();return t.done?t:{done:!1,value:e.get(t.value)}},t},o.entries=function(){var t,e=this,r=this.keys();return(t={})[Ct]=function(){return e.entries()},t.next=function(){var t=r.next();if(t.done)return t;var n=e.get(t.value);return{done:!1,value:[t.value,n]}},t},o[Ct]=function(){return this.entries()},r}(),s=function(){function e(t,e){return this[zt]={i:3,l:e,A:e?e.A:lt(),P:!1,I:!1,o:void 0,t:t,k:this,p:new Map,O:!1,C:!1},this}t(e,Set);var o=e.prototype;return Object.defineProperty(o,"size",{get:function(){return ut(this[zt]).size}}),o.has=function(t){var e=this[zt];return n(e),e.o?!!e.o.has(t)||!(!e.p.has(t)||!e.o.has(e.p.get(t))):e.t.has(t)},o.add=function(t){var e=this[zt];return n(e),this.has(t)||(r(e),xt(e),e.o.add(t)),this},o.delete=function(t){if(!this.has(t))return!1;var e=this[zt];return n(e),r(e),xt(e),e.o.delete(t)||!!e.p.has(t)&&e.o.delete(e.p.get(t))},o.clear=function(){var t=this[zt];n(t),ut(t).size&&(r(t),xt(t),t.o.clear())},o.values=function(){var t=this[zt];return n(t),r(t),t.o.values()},o.entries=function(){var t=this[zt];return n(t),r(t),t.o.entries()},o.keys=function(){return this.values()},o[Ct]=function(){return this.values()},o.forEach=function(t,e){for(var r=this.values(),n=r.next();!n.done;)t.call(e,n.value,n.value,this),n=r.next()},e}();!function(t,e){Yt[t]||(Yt[t]=e)}("MapSet",{N:function(t,e){return new i(t,e)},T:function(t,e){return new s(t,e)}})}();class Oe extends x{constructor(t,e,r,...n){super(t),this.$type=e,this.$target=r,this.$args=n,this.$_constructed=!0}get $stageSubject(){const t=this;return this.$_stageSubject||(this.$_stageSubject=T(ee,re,ne,oe,ie),this.$_stageSubject.subscribe({next(e){t.$stage=e},error(){}})),this.$_stageSubject}get $stage(){return this.$_stage}$perform(){const t=this;return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=void 0,n=void 0;return O(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&u(t[0])&&(t=t[0]),A(t,n).lift(new Q(r))}(this,T(ee,re,ne,oe,ie)).pipe(D(([e,r])=>({value:e,type:t.$type,target:t.$target,stage:r,event:t})),we("stage"))}}return Oe.create=(...t)=>new Oe(...t).$perform,{...se,utils:be,Mirror:class extends x{constructor(t,e=Zt){super(t),this.$configure(e),this.$_constructed=!0}$configure(t={}){if(this.$type=function(t,e=Zt){return e===Zt&&(e=t.value),fe(e)?Wt:ce(e)?Bt:Jt}(this,this.value),!ce(t)&&!fe(t))return this.$configure({});const{name:e=Xt,test:r=Zt,type:n=Zt}=pe(t);ye(e)&&(this.$name=e),ye(r)&&(this.$_test=r),ye(n)&&(this.$type=n)}get $test(){return he(this.$_test)?this.$_test:void 0}get $_queue(){var t;return this.$__queue||((t=this).$__queue=(new E).pipe(Se(xe(t))),t.$__queue.subscribe({next(e){t.$commit(e)},error(){},complete(){t.$__queue=null}})),this.$__queue}next(t){this.$_constructed?this.$_queue.next(t):super.next(t)}$mutate(t){return this.$_mutationQueue.next(Event.$perform(t,"mutate",this)),this}get $_mutationQueue(){return this.$__mutationQueue||(this.$__mutationQueue=new x([])),this.$__mutationQueue}$try(t,e,r,n){return this.$_thenCalled=!1,this.$_trialValue=t,he(e)&&this.$then(e),he(r)&&this.$catch(r),he(n)&&this.$finally(n),this}get $_eventQueue(){return this.$__eventQueue||(this.$__eventQueue=new x(Zt),this.$on("fn")),this.$__eventQueue}$on(t,e=ne,r=Zt){const n=this;this.$_eventQueue.pipe(W(o=>o.type===t&&(ae(e)?e.includes(o.stage):o.stage===e&&(!he(r)||r(o.value,o,n)))))}$do(t,...e){new Event(r=>t(r,this,...e),"fn").$perform().subscribe(t=>{this.isStopped||this.$_eventQueue.next(t)})}$then(t){return this.$errors()||(this.$commit(),this.$_do(t)),this}$catch(t,e=!1){const r=this.$errors();return r&&(t(r,this.value,this),e||this.$clearTrial()),this}$_do(t,...e){if(he(t))try{e.length?t(...e):t(this,this.value)}catch(t){console.warn(t)}}$finally(t){return this.$flush(),this.$_do(t),this}$errors(t=Zt){if(ye(t)||(t=this.getValue()),!he(this.$test))return!1;try{return this.$test(t)}catch(t){return t}}get $isTrying(){return ye(this.$_trialValue)}$isValid(t=Zt){return ye(t)||(t=this.getValue()),!this.$errors(t)}getValue(){return ye(this.$_trialValue)?this.$_trialValue:super.getValue()}$commit(t=Zt){return ye(t)?super.next(t):this.$isTrying&&super.next(this.$_trialValue),this.$clearTrial(),this}$flush(){return this.$isTrying&&(this.$errors()||this.$commit(),this.$clearTrial()),this}$clearTrial(){this.$_trialValue=void 0}},mirrorWatcher:function(t){let e;Object.defineProperty(t,"$$watcher",{configurable:!1,enumerable:!1,value:new E}),Object.defineProperty(t,"$_prior",{get:()=>e,set(r){const n=e;e=r,t.$$watcher&&t.$$say("(setting)","$_prior",{to:e,from:n})}}),Object.defineProperty(t,"$$say",{value:(e,r,n=Zt)=>{ce(e)&&(r=e.source,n=e.value,e=e.message),t.$$watcher.next({message:e,source:r,value:ye(n)?n:e.value,mirrorValue:t.value,name:t.$name})}})},Event:Oe}}));
